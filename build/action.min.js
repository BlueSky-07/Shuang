"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}Shuang.app.action={init:function f(){var b=this;function a(a,b,c){b.forEach(function(b){var c=document.createElement("option");b.disabled&&c.setAttribute("disabled","disabled"),c.innerText=b.text||b,a.appendChild(c)}),a.onchange=function(a){c(a.target.value)}}if(navigator&&navigator.userAgent){var g=navigator.userAgent;/Windows/.test(g)&&(Shuang.resource.emoji={right:"\u2714\uFE0F",wrong:"\u274C"})}var c=Object.values(Shuang.resource.schemeList),d={common:c.filter(function(a){return!a.endsWith("*")}),uncommon:c.filter(function(a){return a.endsWith("*")&&!a.endsWith("**")}).map(function(a){return a.slice(0,-1)}),rare:c.filter(function(a){return a.endsWith("**")}).map(function(a){return a.slice(0,-2)})},e=[{disabled:!0,text:"\u5E38\u89C1"}].concat(_toConsumableArray(d.common),[{disabled:!0,text:"\u5C0F\u4F17"}],_toConsumableArray(d.uncommon),[{disabled:!0,text:"\u7231\u597D\u8005"}],_toConsumableArray(d.rare));a($("#scheme-select"),e,function(a){Shuang.app.setting.setScheme(a)}),a($("#mode-select"),Object.values(Shuang.app.modeList).map(function(a){return a.name}),function(a){Shuang.app.setting.setMode(a),b.next()}),Shuang.core.current=new Shuang.core.model("sh","uang"),$("#q").innerHTML=Shuang.core.current.view.sheng+Shuang.core.current.view.yun,$("#dict").innerHTML=Shuang.core.current.dict,Shuang.app.setting.reload(),document.addEventListener("keydown",function(a){[27,9,13,32].includes(a.keyCode)&&a.preventDefault()}),document.addEventListener("keyup",function(a){b.keyPressed(a)}),$("#pic-switcher").addEventListener("change",function(a){Shuang.app.setting.setPicVisible(a.target.checked)}),$("#dark-mode-switcher").addEventListener("change",function(a){Shuang.app.setting.setDarkMode(a.target.checked)}),$("#auto-next-switcher").addEventListener("change",function(a){Shuang.app.setting.setAutoNext(a.target.checked)}),$("#auto-clear-switcher").addEventListener("change",function(a){Shuang.app.setting.setAutoClear(a.target.checked)}),$(".pay-name#alipay").addEventListener("mouseover",function(){Shuang.app.action.qrShow("alipay-qr")}),$("#alipay-qr").addEventListener("click",function(a){Shuang.app.action.qrHide(a.target)}),$("#alipay-qr").addEventListener("mouseout",function(a){Shuang.app.action.qrHide(a.target)}),$(".pay-name#wxpay").addEventListener("mouseover",function(){Shuang.app.action.qrShow("wxpay-qr")}),$("#wxpay-qr").addEventListener("click",function(a){Shuang.app.action.qrHide(a.target)}),$("#wxpay-qr").addEventListener("mouseout",function(a){Shuang.app.action.qrHide(a.target)}),$("#wx-name").addEventListener("mouseover",function(){Shuang.app.action.qrShow("wx-qr")}),$("#wx-qr").addEventListener("click",function(a){Shuang.app.action.qrHide(a.target)}),$("#wx-qr").addEventListener("mouseout",function(a){Shuang.app.action.qrHide(a.target)}),$("#dict").addEventListener("click",function(){Shuang.core.current.beforeJudge(),$("#a").value=Shuang.core.current.scheme.values().next().value,b.judge()}),this.redo()},keyPressed:function e(b){var c=$("#a");switch(b.keyCode){case 27:this.redo();break;case 9:Shuang.core.current.beforeJudge(),c.value=Shuang.core.current.scheme.values().next().value,this.judge();break;case 13:case 32:this.judge()?this.next():this.redo();break;default:c.value=c.value.slice(0,2).replace(/[^a-zA-Z;]/g,"");var a=2===c.value.length,d=this.judge();a&&(d&&"true"===Shuang.app.setting.config.autoNext?this.next():!d&&"true"===Shuang.app.setting.config.autoClear&&this.redo());}},judge:function f(){var a=this,b=$("#a"),c=$("#btn"),d=b.value[0],e=b.value[1];return e&&Shuang.core.current.judge(d,e)?(c.onclick=function(){a.next()},c.innerText=Shuang.resource.emoji.right,!0):(c.onclick=function(){a.redo()},c.innerText=Shuang.resource.emoji.wrong,!1)},redo:function d(){var a=this,b=$("#a"),c=$("#btn");b.value="",b.focus(),c.onclick=function(){a.redo()},c.innerText=Shuang.resource.emoji.wrong},next:function a(){switch(this.redo(),Shuang.app.setting.config.mode){case"all-random":Shuang.core.current=Shuang.core.model.getRandom();break;case"all-order":Shuang.core.current=Shuang.core.model.getByOrder();break;case"hard-random":Shuang.core.current=Shuang.core.model.getHardRandom();break;case"hard-random-without-pinyin":do Shuang.core.current=Shuang.core.model.getHardRandom();while(Array.isArray(Shuang.core.current.dict));}Shuang.core.history.includes(Shuang.core.current.sheng+Shuang.core.current.yun)?this.next():Shuang.core.history=Shuang.core.history.concat([Shuang.core.current.sheng+Shuang.core.current.yun]).slice(-100),$("#q").innerHTML=Shuang.core.current.view.sheng+Shuang.core.current.view.yun,$("#dict").innerHTML=Shuang.core.current.dict},qrShow:function b(a){$("#"+a).style.display="block"},qrHide:function b(a){a.style.display="none"}};