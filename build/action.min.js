"use strict";function _slicedToArray(b,c){return _arrayWithHoles(b)||_iterableToArrayLimit(b,c)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(b,c){var d=[],e=!0,f=!1,g=void 0;try{for(var h,i=b[Symbol.iterator]();!(e=(h=i.next()).done)&&(d.push(h.value),!(c&&d.length===c));e=!0);}catch(b){f=!0,g=b}finally{try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}}return d}function _arrayWithHoles(b){if(Array.isArray(b))return b}function _toConsumableArray(b){return _arrayWithoutHoles(b)||_iterableToArray(b)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(b){if(Symbol.iterator in Object(b)||"[object Arguments]"===Object.prototype.toString.call(b))return Array.from(b)}function _arrayWithoutHoles(b){if(Array.isArray(b)){for(var c=0,d=Array(b.length);c<b.length;c++)d[c]=b[c];return d}}Shuang.app.action={init:function init(){var c=this;function b(b,c,d){c.forEach(function(c){var d=document.createElement("option");c.disabled&&d.setAttribute("disabled","disabled"),d.innerText=c.text||c,b.appendChild(d)}),b.onchange=function(b){d(b.target.value)}}navigator&&navigator.userAgent&&/Windows/.test(navigator.userAgent)&&(Shuang.resource.emoji={right:"\u2714\uFE0F",wrong:"\u274C"});var d=Object.values(Shuang.resource.schemeList),e={common:d.filter(function(b){return!b.endsWith("*")}),uncommon:d.filter(function(b){return b.endsWith("*")&&!b.endsWith("**")}).map(function(b){return b.slice(0,-1)}),rare:d.filter(function(b){return b.endsWith("**")}).map(function(b){return b.slice(0,-2)})},f=[{disabled:!0,text:"\u5E38\u89C1"}].concat(_toConsumableArray(e.common),[{disabled:!0,text:"\u5C0F\u4F17"}],_toConsumableArray(e.uncommon),[{disabled:!0,text:"\u7231\u597D\u8005"}],_toConsumableArray(e.rare));b($("#scheme-select"),f,function(b){Shuang.app.setting.setScheme(b)}),b($("#mode-select"),Object.values(Shuang.app.modeList).map(function(b){return b.name}),function(b){Shuang.app.setting.setMode(b),c.next()}),Shuang.core.current=new Shuang.core.model("sh","uang"),$("#q").innerText=Shuang.core.current.view.sheng+Shuang.core.current.view.yun,$("#dict").innerText=Shuang.core.current.dict,Shuang.app.setting.reload(),document.addEventListener("keydown",function(b){["Escape","Tab","Enter","Space"].includes(b.code)&&b.preventDefault()}),document.addEventListener("keyup",function(b){c.keyPressed(b)}),$("#pic-switcher").addEventListener("change",function(b){Shuang.app.setting.setPicVisible(b.target.checked)}),$("#dark-mode-switcher").addEventListener("change",function(b){Shuang.app.setting.setDarkMode(b.target.checked)}),$("#auto-next-switcher").addEventListener("change",function(b){Shuang.app.setting.setAutoNext(b.target.checked)}),$("#auto-clear-switcher").addEventListener("change",function(b){Shuang.app.setting.setAutoClear(b.target.checked)}),$(".pay-name#alipay").addEventListener("mouseover",function(){Shuang.app.action.qrShow("alipay-qr")}),$("#alipay-qr").addEventListener("click",function(b){Shuang.app.action.qrHide(b.target)}),$("#alipay-qr").addEventListener("mouseout",function(b){Shuang.app.action.qrHide(b.target)}),$(".pay-name#wxpay").addEventListener("mouseover",function(){Shuang.app.action.qrShow("wxpay-qr")}),$("#wxpay-qr").addEventListener("click",function(b){Shuang.app.action.qrHide(b.target)}),$("#wxpay-qr").addEventListener("mouseout",function(b){Shuang.app.action.qrHide(b.target)}),$("#wx-name").addEventListener("mouseover",function(){Shuang.app.action.qrShow("wx-qr")}),$("#wx-qr").addEventListener("click",function(b){Shuang.app.action.qrHide(b.target)}),$("#wx-qr").addEventListener("mouseout",function(b){Shuang.app.action.qrHide(b.target)}),$("#dict").addEventListener("click",function(){Shuang.core.current.beforeJudge(),$("#a").value=Shuang.core.current.scheme.values().next().value,c.judge()}),this.redo()},keyPressed:function keyPressed(b){switch(b.code){case"Escape":this.redo();break;case"Tab":Shuang.core.current.beforeJudge(),$("#a").value=Shuang.core.current.scheme.values().next().value,this.judge();break;case"Enter":case"Space":this.judge()?this.next():this.redo();break;default:$("#a").value=$("#a").value.slice(0,2).replace(/[^a-zA-Z;]/g,"");var c=2===a.value.length,d=this.judge();c&&(d&&"true"===Shuang.app.setting.config.autoNext?this.next():!d&&"true"===Shuang.app.setting.config.autoClear&&this.redo());}},judge:function judge(){var b=$("#a"),c=$("#btn"),d=_slicedToArray(b.value,2),e=d[0],f=d[1];return f&&Shuang.core.current.judge(e,f)?(c.onclick=this.next.bind(this),c.innerText=Shuang.resource.emoji.right,!0):(c.onclick=this.redo.bind(this),c.innerText=Shuang.resource.emoji.wrong,!1)},redo:function redo(){$("#a").value="",$("#a").focus(),$("#btn").onclick=this.redo.bind(this),$("#btn").innerText=Shuang.resource.emoji.wrong},next:function next(){switch(this.redo(),Shuang.app.setting.config.mode){case"all-random":Shuang.core.current=Shuang.core.model.getRandom();break;case"all-order":Shuang.core.current=Shuang.core.model.getByOrder();break;case"hard-random":Shuang.core.current=Shuang.core.model.getHardRandom();break;case"hard-random-without-pinyin":do Shuang.core.current=Shuang.core.model.getHardRandom();while(Array.isArray(Shuang.core.current.dict));}Shuang.core.history.includes(Shuang.core.current.sheng+Shuang.core.current.yun)?this.next():Shuang.core.history=[].concat(_toConsumableArray(Shuang.core.history),[Shuang.core.current.sheng+Shuang.core.current.yun]).slice(-100),$("#q").innerText=Shuang.core.current.view.sheng+Shuang.core.current.view.yun,$("#dict").innerText=Shuang.core.current.dict},qrShow:function qrShow(b){$("#"+b).style.display="block"},qrHide:function qrHide(b){b.style.display="none"}};